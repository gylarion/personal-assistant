"""
–ú–æ–¥—É–ª—å –¥–ª—è –õ—é–¥–∏–Ω–∏ 2: "–õ–æ–≥—ñ–∫–∞ –ö–æ–Ω—Ç–∞–∫—Ç—ñ–≤ (Create + Birthday)"

–í—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω—ñ—Å—Ç—å:
- –î–æ–¥–∞–≤–∞–Ω–Ω—è –Ω–æ–≤–∏—Ö –∫–æ–Ω—Ç–∞–∫—Ç—ñ–≤ (add_contact)
- –ü–æ—à—É–∫ –Ω–∞–π–±–ª–∏–∂—á–∏—Ö –¥–Ω—ñ–≤ –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è (get_upcoming_birthdays)

–ê–≤—Ç–æ—Ä: @–í–ª–∞–¥–∏–º–∏—Ä –†–æ—Å–∏–Ω–µ—Ü (–õ—é–¥–∏–Ω–∞ 2)
–ü—Ä–æ–µ–∫—Ç: Project-Group-17 - Personal Assistant
GitHub: https://github.com/gylarion/personal-assistant

–í–ê–ñ–õ–ò–í–û: –¶–µ–π –º–æ–¥—É–ª—å –ù–ï –ø—Ä–∞—Ü—é—î –∑ –Ω–æ—Ç–∞—Ç–∫–∞–º–∏!
–ù–æ—Ç–∞—Ç–∫–∏ –¥–æ–¥–∞—é—Ç—å—Å—è —á–µ—Ä–µ–∑ –º–æ–¥—É–ª—å –õ—é–¥–∏–Ω–∏ 5 
"""

# –Ü–º–ø–æ—Ä—Ç–∏ –≤—ñ–¥ –õ—é–¥–∏–Ω–∏ 1 (–ê—Ä—Ö—ñ—Ç–µ–∫—Ç–æ—Ä)
try:
    from classes import Contact, AddressBook
    from storage import save_data
except ImportError:
    # –ó–∞–≥–ª—É—à–∫–∞ –¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è –±–µ–∑ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π
    # –í —Ä–µ–∞–ª—å–Ω–æ–º—É –ø—Ä–æ–µ–∫—Ç—ñ —Ü—ñ —ñ–º–ø–æ—Ä—Ç–∏ –º–∞—é—Ç—å –ø—Ä–∞—Ü—é–≤–∞—Ç–∏
    Contact = None
    AddressBook = None
    save_data = None


def input_error(func):
    """
    –î–µ–∫–æ—Ä–∞—Ç–æ—Ä –¥–ª—è —Ü–µ–Ω—Ç—Ä–∞–ª—ñ–∑–æ–≤–∞–Ω–æ—ó –æ–±—Ä–æ–±–∫–∏ –ø–æ–º–∏–ª–æ–∫ –≤–≤–µ–¥–µ–Ω–Ω—è.
    
    –ü–µ—Ä–µ—Ö–æ–ø–ª—é—î –≤–∏–∫–ª—é—á–µ–Ω–Ω—è —Ç–∞ –ø–æ–≤–µ—Ä—Ç–∞—î –∑—Ä–æ–∑—É–º—ñ–ª—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ—é –º–æ–≤–æ—é:
    - ValueError: –ø—Ä–æ–±–ª–µ–º–∏ –∑ –≤–∞–ª—ñ–¥–∞—Ü—ñ—î—é (—Ç–µ–ª–µ—Ñ–æ–Ω, email, –¥–∞—Ç–∞)
    - KeyError: –∫–æ–Ω—Ç–∞–∫—Ç –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ
    - IndexError: –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç –∫–æ–º–∞–Ω–¥–∏
    - Exception: —ñ–Ω—à—ñ –ø–æ–º–∏–ª–∫–∏
    
    Args:
        func: –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –¥–µ–∫–æ—Ä—É–≤–∞–Ω–Ω—è
        
    Returns:
        function: –û–±–≥–æ—Ä–Ω—É—Ç–∞ —Ñ—É–Ω–∫—Ü—ñ—è –∑ –æ–±—Ä–æ–±–∫–æ—é –ø–æ–º–∏–ª–æ–∫
    """
    def inner(*args, **kwargs):
        try:
            return func(*args, **kwargs)
        except ValueError as e:
            return f"–ü–æ–º–∏–ª–∫–∞: {str(e)}"
        except KeyError:
            return "–ü–æ–º–∏–ª–∫–∞: –ö–æ–Ω—Ç–∞–∫—Ç –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ."
        except IndexError:
            return "–ü–æ–º–∏–ª–∫–∞: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç –∫–æ–º–∞–Ω–¥–∏."
        except Exception as e:
            return f"–ü–æ–º–∏–ª–∫–∞: {str(e)}"
    return inner


@input_error
def add_contact(*args):
    """
    –î–æ–¥–∞—î –Ω–æ–≤–∏–π –∫–æ–Ω—Ç–∞–∫—Ç –∞–±–æ —Ç–µ–ª–µ—Ñ–æ–Ω –¥–æ —ñ—Å–Ω—É—é—á–æ–≥–æ –∫–æ–Ω—Ç–∞–∫—Ç—É.
    
    –§—É–Ω–∫—Ü—ñ—è —Ä–µ–∞–ª—ñ–∑—É—î –∫–æ–º–∞–Ω–¥—É —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫–æ–Ω—Ç–∞–∫—Ç—É –∑–≥—ñ–¥–Ω–æ –¢–ó Project-Group-17.
    –Ø–∫—â–æ –∫–æ–Ω—Ç–∞–∫—Ç –∑ —Ç–∞–∫–∏–º —ñ–º'—è–º –≤–∂–µ —ñ—Å–Ω—É—î, —Ñ—É–Ω–∫—Ü—ñ—è –¥–æ–¥–∞—î –Ω–æ–≤–∏–π —Ç–µ–ª–µ—Ñ–æ–Ω 
    –¥–æ —ñ—Å–Ω—É—é—á–æ–≥–æ –∫–æ–Ω—Ç–∞–∫—Ç—É.
    
    ‚ö†Ô∏è –í–ê–ñ–õ–ò–í–û: –¶—è —Ñ—É–Ω–∫—Ü—ñ—è –ù–ï –ø—Ä–∞—Ü—é—î –∑ –Ω–æ—Ç–∞—Ç–∫–∞–º–∏!
    –ù–æ—Ç–∞—Ç–∫–∏ –¥–æ–¥–∞—é—Ç—å—Å—è –æ–∫—Ä–µ–º–æ —á–µ—Ä–µ–∑ —Ñ—É–Ω–∫—Ü—ñ—ó –õ—é–¥–∏–Ω–∏ 5 (@Sergei Mochtchenkov).
    
    –ó–≥—ñ–¥–Ω–æ –¢–ó: "–ü–∞—Ä—Å–∏—Ç–∏ args (—ñ–º'—è, —Ç–µ–ª–µ—Ñ–æ–Ω...). –í–∞–∂–ª–∏–≤–æ: –Ω–æ—Ç–∞—Ç–∫–∏ —Ç—É—Ç –Ω–µ –¥–æ–¥–∞—é—Ç—å—Å—è."
    
    Args:
        *args: –°–ø–∏—Å–æ–∫ –∞—Ä–≥—É–º–µ–Ω—Ç—ñ–≤ –∫–æ–º–∞–Ω–¥–∏
               args[0] - —ñ–º'—è –∫–æ–Ω—Ç–∞–∫—Ç—É (str)
               args[1] - —Ç–µ–ª–µ—Ñ–æ–Ω (str, –º–∞—î –±—É—Ç–∏ 10 —Ü–∏—Ñ—Ä)
               args[-1] - book (AddressBook) - –æ—Å—Ç–∞–Ω–Ω—ñ–π –µ–ª–µ–º–µ–Ω—Ç
        
    Returns:
        str: –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ–ø–µ—Ä–∞—Ü—ñ—ó
        
    Examples:
        >>> add_contact('–Ü–≤–∞–Ω', '0671234567', book)
        '–ö–æ–Ω—Ç–∞–∫—Ç –¥–æ–¥–∞–Ω–æ.'
        
        >>> add_contact('–Ü–≤–∞–Ω', '0509876543', book)  # –∫–æ–Ω—Ç–∞–∫—Ç –≤–∂–µ —ñ—Å–Ω—É—î
        '–ö–æ–Ω—Ç–∞–∫—Ç –æ–Ω–æ–≤–ª–µ–Ω–æ.'
        
    Raises:
        ValueError: –Ø–∫—â–æ —Ç–µ–ª–µ—Ñ–æ–Ω –Ω–µ –≤–∞–ª—ñ–¥–Ω–∏–π (—á–µ—Ä–µ–∑ –∫–ª–∞—Å Contact –≤—ñ–¥ –õ—é–¥–∏–Ω–∏ 1)
        IndexError: –Ø–∫—â–æ –Ω–µ –≤–∫–∞–∑–∞–Ω–æ —ñ–º'—è –∞–±–æ —Ç–µ–ª–µ—Ñ–æ–Ω
        
    Note:
        –§—É–Ω–∫—Ü—ñ—è –≤–∏–∫–ª–∏–∫–∞—î save_data() –ø—ñ—Å–ª—è —É—Å–ø—ñ—à–Ω–æ–≥–æ –¥–æ–¥–∞–≤–∞–Ω–Ω—è –∫–æ–Ω—Ç–∞–∫—Ç—É
        –∑–≥—ñ–¥–Ω–æ –≤–∏–º–æ–≥ –¢–ó: "–î–æ–¥–∞–≤–∞—Ç–∏ –∫–æ–Ω—Ç–∞–∫—Ç –¥–æ AddressBook —Ç–∞ –≤–∏–∫–ª–∏–∫–∞—Ç–∏ save_data()."
    """
    # –û—Ç—Ä–∏–º—É—î–º–æ book –∑ –æ—Å—Ç–∞–Ω–Ω—å–æ–≥–æ –∞—Ä–≥—É–º–µ–Ω—Ç—É, —Ä–µ—à—Ç–∞ - –¥–∞–Ω—ñ –∫–æ–Ω—Ç–∞–∫—Ç—É
    *contact_args, book = args
    
    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –º—ñ–Ω—ñ–º–∞–ª—å–Ω–æ—ó –∫—ñ–ª—å–∫–æ—Å—Ç—ñ –∞—Ä–≥—É–º–µ–Ω—Ç—ñ–≤
    if len(contact_args) < 2:
        return ("‚ùå –ü–æ–º–∏–ª–∫–∞: –ü–æ—Ç—Ä—ñ–±–Ω–æ –≤–∫–∞–∑–∞—Ç–∏ —ñ–º'—è —Ç–∞ —Ç–µ–ª–µ—Ñ–æ–Ω.\n"
                "üí° –§–æ—Ä–º–∞—Ç: –¥–æ–¥–∞—Ç–∏ [—ñ–º'—è] [—Ç–µ–ª–µ—Ñ–æ–Ω]\n"
                "üí° –ù–∞–ø—Ä–∏–∫–ª–∞–¥: –¥–æ–¥–∞—Ç–∏ –Ü–≤–∞–Ω 0671234567")
    
    # –ü–∞—Ä—Å–∏–º–æ –∞—Ä–≥—É–º–µ–Ω—Ç–∏: —ñ–º'—è —Ç–∞ —Ç–µ–ª–µ—Ñ–æ–Ω (–∑–≥—ñ–¥–Ω–æ –¢–ó)
    name, phone, *_ = contact_args
    
    # –®—É–∫–∞—î–º–æ —ñ—Å–Ω—É—é—á–∏–π –∫–æ–Ω—Ç–∞–∫—Ç —á–µ—Ä–µ–∑ –º–µ—Ç–æ–¥ find() AddressBook (API –õ—é–¥–∏–Ω–∏ 1)
    record = book.find(name)
    message = "–ö–æ–Ω—Ç–∞–∫—Ç –æ–Ω–æ–≤–ª–µ–Ω–æ."
    
    # –Ø–∫—â–æ –∫–æ–Ω—Ç–∞–∫—Ç –Ω–µ —ñ—Å–Ω—É—î, —Å—Ç–≤–æ—Ä—é—î–º–æ –Ω–æ–≤–∏–π –æ–±'—î–∫—Ç Contact
    # –ó–≥—ñ–¥–Ω–æ –¢–ó: "–°—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ –æ–±'—î–∫—Ç Contact(...)"
    if record is None:
        try:
            # –°—Ç–≤–æ—Ä—é—î–º–æ –Ω–æ–≤–∏–π Contact –∑ —ñ–º–µ–Ω–µ–º
            # –í–∞–ª—ñ–¥–∞—Ü—ñ—è –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –∫–ª–∞—Å—É Contact (–õ—é–¥–∏–Ω–∞ 1)
            record = Contact(name)
            message = "–ö–æ–Ω—Ç–∞–∫—Ç –¥–æ–¥–∞–Ω–æ."
        except ValueError as e:
            # –ó–≥—ñ–¥–Ω–æ –¢–ó: "–û–±—Ä–æ–±–ª—è—Ç–∏ –ø–æ–º–∏–ª–∫–∏ –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó –≤—ñ–¥ –∫–ª–∞—Å—É Contact (try...except ValueError)"
            return f"‚ùå –ü–æ–º–∏–ª–∫–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫–æ–Ω—Ç–∞–∫—Ç—É: {str(e)}"
    
    # –î–æ–¥–∞—î–º–æ —Ç–µ–ª–µ—Ñ–æ–Ω –¥–æ –∫–æ–Ω—Ç–∞–∫—Ç—É
    if phone:
        try:
            # –í–∞–ª—ñ–¥–∞—Ü—ñ—è –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –∫–ª–∞—Å—É Phone (–õ—é–¥–∏–Ω–∞ 1)
            # –í–∏–∫–ª–∏–∫–∞—î–º–æ –º–µ—Ç–æ–¥ add_phone() —ñ –ª–æ–≤–∏–º–æ ValueError
            record.add_phone(phone)
            
            # –î–æ–¥–∞—î–º–æ –Ω–æ–≤–∏–π –∑–∞–ø–∏—Å –¥–æ –∞–¥—Ä–µ—Å–Ω–æ—ó –∫–Ω–∏–≥–∏
            # –ó–≥—ñ–¥–Ω–æ –¢–ó: "–î–æ–¥–∞–≤–∞—Ç–∏ –∫–æ–Ω—Ç–∞–∫—Ç –¥–æ AddressBook"
            if message == "–ö–æ–Ω—Ç–∞–∫—Ç –¥–æ–¥–∞–Ω–æ.":
                book.add_record(record)
            
        except ValueError as e:
            # –û–±—Ä–æ–±–ª—è—î–º–æ –ø–æ–º–∏–ª–∫–∏ –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó —Ç–µ–ª–µ—Ñ–æ–Ω—É –≤—ñ–¥ –∫–ª–∞—Å—É Phone
            return f"‚ùå {str(e)}\nüí° –¢–µ–ª–µ—Ñ–æ–Ω –ø–æ–≤–∏–Ω–µ–Ω –º—ñ—Å—Ç–∏—Ç–∏ 10 —Ü–∏—Ñ—Ä (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥: 0671234567)"
    
    # –ó–≥—ñ–¥–Ω–æ –¢–ó: "–î–æ–¥–∞–≤–∞—Ç–∏ –∫–æ–Ω—Ç–∞–∫—Ç –¥–æ AddressBook —Ç–∞ –≤–∏–∫–ª–∏–∫–∞—Ç–∏ save_data()"
    save_data(book)
    
    return message


@input_error
def get_upcoming_birthdays(*args):
    """
    –ü–æ–≤–µ—Ä—Ç–∞—î —Å–ø–∏—Å–æ–∫ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤, —è–∫–∏—Ö –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø—Ä–∏–≤—ñ—Ç–∞—Ç–∏ –∑ –¥–Ω–µ–º –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ —Ç–∏–∂–Ω—è.
    
    –§—É–Ω–∫—Ü—ñ—è —Ä–µ–∞–ª—ñ–∑—É—î –ø–æ—à—É–∫ –Ω–∞–π–±–ª–∏–∂—á–∏—Ö –¥–Ω—ñ–≤ –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è –∑–≥—ñ–¥–Ω–æ –¢–ó Project-Group-17.
    
    –õ–æ–≥—ñ–∫–∞ —Ä–æ–±–æ—Ç–∏ (—Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–∞ –≤ AddressBook.get_upcoming_birthdays() - –õ—é–¥–∏–Ω–∞ 1):
    1. –®—É–∫–∞—î –¥–Ω—ñ –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è –Ω–∞ –Ω–∞—Å—Ç—É–ø–Ω—ñ 7 –¥–Ω—ñ–≤ –≤—ñ–¥ –ø–æ—Ç–æ—á–Ω–æ—ó –¥–∞—Ç–∏
    2. –Ø–∫—â–æ –¥–µ–Ω—å –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è –ø—Ä–∏–ø–∞–¥–∞—î –Ω–∞ –≤–∏—Ö—ñ–¥–Ω—ñ (—Å—É–±–æ—Ç–∞/–Ω–µ–¥—ñ–ª—è),
       –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç—å –ø—Ä–∏–≤—ñ—Ç–∞–Ω–Ω—è –Ω–∞ –Ω–∞—Å—Ç—É–ø–Ω–∏–π –ø–æ–Ω–µ–¥—ñ–ª–æ–∫
    3. –í—Ä–∞—Ö–æ–≤—É—î –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–Ω—è —Ä–æ–∫—É —è–∫—â–æ –¥–µ–Ω—å –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è –≤–∂–µ –º–∏–Ω—É–≤ —Ü—å–æ–≥–æ —Ä–æ–∫—É
    
    Args:
        *args: –ê—Ä–≥—É–º–µ–Ω—Ç–∏ –∫–æ–º–∞–Ω–¥–∏
               args[-1] - book (AddressBook) - –æ—Å—Ç–∞–Ω–Ω—ñ–π –µ–ª–µ–º–µ–Ω—Ç
        
    Returns:
        str: –§–æ—Ä–º–∞—Ç–æ–≤–∞–Ω–∏–π —Å–ø–∏—Å–æ–∫ –Ω–∞–π–±–ª–∏–∂—á–∏—Ö –¥–Ω—ñ–≤ –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è –∞–±–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
             —â–æ –Ω–µ–º–∞—î –¥–Ω—ñ–≤ –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è –Ω–∞ –Ω–∞—Å—Ç—É–ø–Ω–æ–º—É —Ç–∏–∂–Ω—ñ
        
    Examples:
        >>> get_upcoming_birthdays(book)
        '–ù–∞–π–±–ª–∏–∂—á—ñ –¥–Ω—ñ –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è:
        –Ü–≤–∞–Ω: 2025.11.15
        –ú–∞—Ä—ñ—è: 2025.11.18'
        
        >>> get_upcoming_birthdays(book)  # —è–∫—â–æ –Ω–µ–º–∞—î –î–ù
        '–ù–µ–º–∞—î –¥–Ω—ñ–≤ –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è –Ω–∞ –Ω–∞—Å—Ç—É–ø–Ω–æ–º—É —Ç–∏–∂–Ω—ñ.'
        
    Algorithm (–≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è –≤ AddressBook):
        - –ü–æ—Ç–æ—á–Ω–∞ –¥–∞—Ç–∞: —Å—å–æ–≥–æ–¥–Ω—ñ
        - –î—ñ–∞–ø–∞–∑–æ–Ω: —Å—å–æ–≥–æ–¥–Ω—ñ + 7 –¥–Ω—ñ–≤
        - –Ø–∫—â–æ –î–ù –≤ —Å—É–±–æ—Ç—É (5) –∞–±–æ –Ω–µ–¥—ñ–ª—é (6) -> –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ –Ω–∞ –ø–æ–Ω–µ–¥—ñ–ª–æ–∫
        - –°–æ—Ä—Ç—É–≤–∞–Ω–Ω—è –∑–∞ –¥–∞—Ç–æ—é –ø—Ä–∏–≤—ñ—Ç–∞–Ω–Ω—è
        
    Note:
        –¶—è —Ñ—É–Ω–∫—Ü—ñ—è –¥–µ–ª–µ–≥—É—î –ª–æ–≥—ñ–∫—É —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É –∫–ª–∞—Å—É AddressBook (–õ—é–¥–∏–Ω–∞ 1).
        –û—á—ñ–∫—É–≤–∞–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç –¥–∞–Ω–∏—Ö –≤—ñ–¥ book.get_upcoming_birthdays():
        [
            {'name': '–Ü–≤–∞–Ω', 'congratulation_date': '2025.11.15'},
            {'name': '–ú–∞—Ä—ñ—è', 'congratulation_date': '2025.11.18'}
        ]
    """
    # –û—Ç—Ä–∏–º—É—î–º–æ book –∑ –æ—Å—Ç–∞–Ω–Ω—å–æ–≥–æ –∞—Ä–≥—É–º–µ–Ω—Ç—É
    if not args:
        return "‚ùå –ü–æ–º–∏–ª–∫–∞: AddressBook –Ω–µ –ø–µ—Ä–µ–¥–∞–Ω–æ."
    
    *_, book = args
    
    # –í–∏–∫–ª–∏–∫–∞—î–º–æ –º–µ—Ç–æ–¥ get_upcoming_birthdays() –∑ AddressBook (API –õ—é–¥–∏–Ω–∏ 1)
    # –í—Å—è –ª–æ–≥—ñ–∫–∞ —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É –¥–Ω—ñ–≤ –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è —Ç–∞–º
    upcoming = book.get_upcoming_birthdays()
    
    # –Ø–∫—â–æ –Ω–µ–º–∞—î –Ω–∞–π–±–ª–∏–∂—á–∏—Ö –¥–Ω—ñ–≤ –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è
    if not upcoming:
        return "–ù–µ–º–∞—î –¥–Ω—ñ–≤ –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è –Ω–∞ –Ω–∞—Å—Ç—É–ø–Ω–æ–º—É —Ç–∏–∂–Ω—ñ."
    
    # –§–æ—Ä–º–∞—Ç—É—î–º–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–ª—è –≤–∏–≤–æ–¥—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–≤—ñ
    result = ["–ù–∞–π–±–ª–∏–∂—á—ñ –¥–Ω—ñ –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è:"]
    for birthday_info in upcoming:
        # –û—á—ñ–∫—É—î–º–æ —Å–ª–æ–≤–Ω–∏–∫ –∑ –∫–ª—é—á–∞–º–∏ 'name' —Ç–∞ 'congratulation_date'
        name = birthday_info.get('name', '–ù–µ–≤—ñ–¥–æ–º–æ')
        date = birthday_info.get('congratulation_date', '–ù–µ–≤—ñ–¥–æ–º–æ')
        result.append(f"{name}: {date}")
    
    return '\n'.join(result)


# –î–æ–¥–∞—Ç–∫–æ–≤–∞ –¥–æ–ø–æ–º—ñ–∂–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è –¥–ª—è —Ä–æ–∑—à–∏—Ä–µ–Ω–æ–≥–æ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫–æ–Ω—Ç–∞–∫—Ç—É
# (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ, —è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ –∫–æ–Ω—Ç–∞–∫—Ç–∏ –∑ —É—Å—ñ–º–∞ –ø–æ–ª—è–º–∏ –≤—ñ–¥—Ä–∞–∑—É)
# –¶—è —Ñ—É–Ω–∫—Ü—ñ—è –ù–ï –≤—Ö–æ–¥–∏—Ç—å –≤ –æ—Å–Ω–æ–≤–Ω–µ –¢–ó, –∞–ª–µ –º–æ–∂–µ –±—É—Ç–∏ –∫–æ—Ä–∏—Å–Ω–æ—é
@input_error
def add_full_contact(*args):
    """
    –î–æ–¥–∞—î –ø–æ–≤–Ω–∏–π –∫–æ–Ω—Ç–∞–∫—Ç –∑ —É—Å—ñ–º–∞ –¥–∞–Ω–∏–º–∏: —ñ–º'—è, —Ç–µ–ª–µ—Ñ–æ–Ω, email, –¥–µ–Ω—å –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è, –∞–¥—Ä–µ—Å–∞.
    
    –¶–µ —Ä–æ–∑—à–∏—Ä–µ–Ω–∞ –≤–µ—Ä—Å—ñ—è add_contact(), —è–∫–∞ –¥–æ–∑–≤–æ–ª—è—î —Å—Ç–≤–æ—Ä–∏—Ç–∏ –∫–æ–Ω—Ç–∞–∫—Ç
    –∑ –ø–æ–≤–Ω–æ—é —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—î—é –æ–¥—Ä–∞–∑—É. –í–∞–ª—ñ–¥–∞—Ü—ñ—è –≤—Å—ñ—Ö –ø–æ–ª—ñ–≤ –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è
    –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –∫–ª–∞—Å—É Contact (–õ—é–¥–∏–Ω–∞ 1).
    
    ‚ö†Ô∏è –í–ê–ñ–õ–ò–í–û: –ù–æ—Ç–∞—Ç–∫–∏ –ù–ï –¥–æ–¥–∞—é—Ç—å—Å—è —Ç—É—Ç!
    –ù–æ—Ç–∞—Ç–∫–∏ –¥–æ–¥–∞—é—Ç—å—Å—è –æ–∫—Ä–µ–º–æ —á–µ—Ä–µ–∑ —Ñ—É–Ω–∫—Ü—ñ—ó –õ—é–¥–∏–Ω–∏ 5.
    
    –¶—è —Ñ—É–Ω–∫—Ü—ñ—è –ù–ï —î –æ–±–æ–≤'—è–∑–∫–æ–≤–æ—é –∑–≥—ñ–¥–Ω–æ –¢–ó, –∞–ª–µ –º–æ–∂–µ –±—É—Ç–∏ –∫–æ—Ä–∏—Å–Ω–æ—é
    –¥–ª—è —à–≤–∏–¥–∫–æ–≥–æ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫–æ–Ω—Ç–∞–∫—Ç—ñ–≤ –∑ —É—Å—ñ–º–∞ –¥–∞–Ω–∏–º–∏.
    
    Args:
        *args: –°–ø–∏—Å–æ–∫ –∞—Ä–≥—É–º–µ–Ω—Ç—ñ–≤
               args[0] - —ñ–º'—è (str)
               args[1] - —Ç–µ–ª–µ—Ñ–æ–Ω (str, 10 —Ü–∏—Ñ—Ä)
               args[2] - email (str, –æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)
               args[3] - –¥–µ–Ω—å –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è (str, DD.MM.YYYY, –æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)
               args[4:] - –∞–¥—Ä–µ—Å–∞ (str, –º–æ–∂–µ –º—ñ—Å—Ç–∏—Ç–∏ –ø—Ä–æ–±—ñ–ª–∏, –æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)
               args[-1] - book (AddressBook)
        
    Returns:
        str: –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ–ø–µ—Ä–∞—Ü—ñ—ó
        
    Examples:
        >>> add_full_contact('–Ü–≤–∞–Ω', '0671234567', 'ivan@mail.com', 
        ...                  '15.03.1990', '–ö–∏—ó–≤', '–≤—É–ª.', '–•—Ä–µ—â–∞—Ç–∏–∫', '1', book)
        '–ü–æ–≤–Ω–∏–π –∫–æ–Ω—Ç–∞–∫—Ç –Ü–≤–∞–Ω —Å—Ç–≤–æ—Ä–µ–Ω–æ:
        –¢–µ–ª–µ—Ñ–æ–Ω: 0671234567
        Email: ivan@mail.com
        –î–µ–Ω—å –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è: 15.03.1990
        –ê–¥—Ä–µ—Å–∞: –ö–∏—ó–≤ –≤—É–ª. –•—Ä–µ—â–∞—Ç–∏–∫ 1'
        
    Raises:
        ValueError: –Ø–∫—â–æ –¥–∞–Ω—ñ –Ω–µ –≤–∞–ª—ñ–¥–Ω—ñ 
        
    Note:
        –û—á—ñ–∫—É–≤–∞–Ω–∏–π API –≤—ñ–¥ –õ—é–¥–∏–Ω–∏ 1:
        - Contact(name) - –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä
        - contact.add_phone(phone) - –¥–æ–¥–∞—Ç–∏ —Ç–µ–ª–µ—Ñ–æ–Ω
        - contact.set_email(email) - –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ email  
        - contact.add_birthday(birthday) - –¥–æ–¥–∞—Ç–∏ –¥–µ–Ω—å –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è
        - contact.set_address(address) - –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –∞–¥—Ä–µ—Å—É
        - book.find(name) - –∑–Ω–∞–π—Ç–∏ –∫–æ–Ω—Ç–∞–∫—Ç
        - book.add_record(contact) - –¥–æ–¥–∞—Ç–∏ –∫–æ–Ω—Ç–∞–∫—Ç
    """
    # –û—Ç—Ä–∏–º—É—î–º–æ book –∑ –æ—Å—Ç–∞–Ω–Ω—å–æ–≥–æ –∞—Ä–≥—É–º–µ–Ω—Ç—É
    *contact_args, book = args
    
    if len(contact_args) < 2:
        return ("–ü–æ–º–∏–ª–∫–∞: –ú—ñ–Ω—ñ–º—É–º –ø–æ—Ç—Ä—ñ–±–Ω–æ —ñ–º'—è —Ç–∞ —Ç–µ–ª–µ—Ñ–æ–Ω.\n"
                "–§–æ—Ä–º–∞—Ç: —ñ–º'—è —Ç–µ–ª–µ—Ñ–æ–Ω [email] [–¥–µ–Ω—å_–Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è] [–∞–¥—Ä–µ—Å–∞]")
    
    name = contact_args[0]
    phone = contact_args[1]
    email = contact_args[2] if len(contact_args) > 2 and contact_args[2].lower() not in ['none', 'null', '-'] else None
    birthday = contact_args[3] if len(contact_args) > 3 and contact_args[3].lower() not in ['none', 'null', '-'] else None
    # –ê–¥—Ä–µ—Å–∞ –º–æ–∂–µ –º—ñ—Å—Ç–∏—Ç–∏ –ø—Ä–æ–±—ñ–ª–∏, —Ç–æ–º—É –æ–±'—î–¥–Ω—É—î–º–æ –≤—Å—ñ –Ω–∞—Å—Ç—É–ø–Ω—ñ –∞—Ä–≥—É–º–µ–Ω—Ç–∏
    address = ' '.join(contact_args[4:]) if len(contact_args) > 4 and contact_args[4].lower() not in ['none', 'null', '-'] else None
    
    # –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ, —á–∏ —ñ—Å–Ω—É—î –∫–æ–Ω—Ç–∞–∫—Ç
    existing_contact = book.find(name)
    if existing_contact:
        return f"–ö–æ–Ω—Ç–∞–∫—Ç {name} –≤–∂–µ —ñ—Å–Ω—É—î. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –∫–æ–º–∞–Ω–¥–∏ —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è (–õ—é–¥–∏–Ω–∞ 4)."
    
    # –°—Ç–≤–æ—Ä—é—î–º–æ –Ω–æ–≤–∏–π –∫–æ–Ω—Ç–∞–∫—Ç (–æ–±—Ä–æ–±–ª—è—î–º–æ –ø–æ–º–∏–ª–∫–∏ –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó –≤—ñ–¥ –∫–ª–∞—Å—É Contact)
    try:
        contact = Contact(name)
    except ValueError as e:
        return f"–ü–æ–º–∏–ª–∫–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫–æ–Ω—Ç–∞–∫—Ç—É: {str(e)}"
    
    # –î–æ–¥–∞—î–º–æ —Ç–µ–ª–µ—Ñ–æ–Ω (–æ–±–æ–≤'—è–∑–∫–æ–≤–∏–π)
    try:
        contact.add_phone(phone)
    except ValueError as e:
        return f"–ü–æ–º–∏–ª–∫–∞ —Ç–µ–ª–µ—Ñ–æ–Ω—É: {str(e)}"
    
    # –î–æ–¥–∞—î–º–æ email —è–∫—â–æ –≤–∫–∞–∑–∞–Ω–æ
    if email:
        try:
            contact.set_email(email)
        except ValueError as e:
            return f"–ü–æ–º–∏–ª–∫–∞ email: {str(e)}"
        except AttributeError:
            # –Ø–∫—â–æ –º–µ—Ç–æ–¥ set_email –Ω–µ —ñ—Å–Ω—É—î –≤ API –õ—é–¥–∏–Ω–∏ 1
            pass
    
    # –î–æ–¥–∞—î–º–æ –¥–µ–Ω—å –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è —è–∫—â–æ –≤–∫–∞–∑–∞–Ω–æ
    if birthday:
        try:
            contact.add_birthday(birthday)
        except ValueError as e:
            return f"–ü–æ–º–∏–ª–∫–∞ –¥–Ω—è –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è: {str(e)}"
        except AttributeError:
            # –Ø–∫—â–æ –º–µ—Ç–æ–¥ add_birthday –Ω–µ —ñ—Å–Ω—É—î –≤ API –õ—é–¥–∏–Ω–∏ 1
            pass
    
    # –î–æ–¥–∞—î–º–æ –∞–¥—Ä–µ—Å—É —è–∫—â–æ –≤–∫–∞–∑–∞–Ω–æ
    if address:
        try:
            contact.set_address(address)
        except ValueError as e:
            return f"–ü–æ–º–∏–ª–∫–∞ –∞–¥—Ä–µ—Å–∏: {str(e)}"
        except AttributeError:
            # –Ø–∫—â–æ –º–µ—Ç–æ–¥ set_address –Ω–µ —ñ—Å–Ω—É—î –≤ API –õ—é–¥–∏–Ω–∏ 1
            pass
    
    # –ó–±–µ—Ä—ñ–≥–∞—î–º–æ –∫–æ–Ω—Ç–∞–∫—Ç –¥–æ –∞–¥—Ä–µ—Å–Ω–æ—ó –∫–Ω–∏–≥–∏
    book.add_record(contact)
    
    # –í–∏–∫–ª–∏–∫–∞—î–º–æ save_data() –¥–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –∑–º—ñ–Ω
    save_data(book)
    
    # –§–æ—Ä–º—É—î–º–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç
    result = [f"–ü–æ–≤–Ω–∏–π –∫–æ–Ω—Ç–∞–∫—Ç {name} —Å—Ç–≤–æ—Ä–µ–Ω–æ:"]
    result.append(f"üìû –¢–µ–ª–µ—Ñ–æ–Ω: {phone}")
    if email:
        result.append(f"üìß Email: {email}")
    if birthday:
        result.append(f"üéÇ –î–µ–Ω—å –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è: {birthday}")
    if address:
        result.append(f"üìç –ê–¥—Ä–µ—Å–∞: {address}")

    return '\n'.join(result)


